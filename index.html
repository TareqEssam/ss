<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø°ÙƒÙŠ</title>
  
  <!-- Ø£Ø¶Ù Ù…Ù„Ù CSS Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© -->
  <div id="app">
    <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© UIController -->
  </div>

  <!-- ========================================
       Ø§Ù„Ø®Ø·ÙˆØ© 1: Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¬Ù‡ÙŠØ©
       ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ø£ÙˆÙ„Ø§Ù‹!
  ======================================== -->
  <script src="data/activity_vectors.js"></script>
  <script src="data/decision104_vectors.js"></script>
  <script src="data/industrial_vectors.js"></script>

  <!-- ========================================
       Ø§Ù„Ø®Ø·ÙˆØ© 2: Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†ØµÙŠØ© (Ø§Ù„Ù…Ø´ÙˆØ´Ø©)
  ======================================== -->
  <script src="js/activity_database-s.js"></script>
  <script src="js/decision104_database-s.js"></script>
  <script src="js/industrial_database-s.js"></script>

  <!-- ========================================
       Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
       ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨!
  ======================================== -->
  <script src="js/arabic-normalizer.js"></script>
  <script src="js/transformers-loader.js"></script>
  <script src="js/vector-engine-v7.js"></script>
  
  <!-- ========================================
       Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
       Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙÙ‚ÙˆØ¯Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©
  ======================================== -->
  
  <!-- Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - Ø§Ø­Ø°Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ù„ÙØ§Øª Ù…ÙÙ‚ÙˆØ¯Ø©) -->
  <!--
  <script>
    // IntentClassifier Ø§Ù„Ø¨Ø¯ÙŠÙ„
    if (typeof IntentClassifier === 'undefined') {
      class IntentClassifier {
        constructor(normalizer, vectorEngine) {
          this.normalizer = normalizer;
          this.vectorEngine = vectorEngine;
        }
        loadKnownEntities(entities) {}
        async classify(query) {
          return {
            queryType: 'simple',
            primaryIntent: 'information',
            suggestedDatabases: ['activity', 'decision104', 'industrial'],
            confidence: 0.7
          };
        }
      }
      window.IntentClassifier = IntentClassifier;
      console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ IntentClassifier Ø§Ù„Ø¨Ø¯ÙŠÙ„');
    }
    
    // IndexedDBManager Ø§Ù„Ø¨Ø¯ÙŠÙ„
    if (typeof IndexedDBManager === 'undefined') {
      class IndexedDBManager {
        async init() { return true; }
        async saveContext(ctx) { localStorage.setItem('ctx', JSON.stringify(ctx)); return true; }
        async loadContext() { try { return JSON.parse(localStorage.getItem('ctx')); } catch { return null; } }
      }
      window.IndexedDBManager = IndexedDBManager;
      console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ IndexedDBManager Ø§Ù„Ø¨Ø¯ÙŠÙ„');
    }
    
    // QueryParser Ø§Ù„Ø¨Ø¯ÙŠÙ„
    if (typeof QueryParser === 'undefined') {
      class QueryParser {
        constructor(normalizer, classifier) {
          this.normalizer = normalizer;
          this.classifier = classifier;
        }
      }
      window.QueryParser = QueryParser;
      console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ QueryParser Ø§Ù„Ø¨Ø¯ÙŠÙ„');
    }
    
    // LearningSystem Ø§Ù„Ø¨Ø¯ÙŠÙ„
    if (typeof LearningSystem === 'undefined') {
      class LearningSystem {
        constructor(dbManager, normalizer) {}
        async initialize() { return true; }
        async getLearnedResponse(query) { return null; }
      }
      window.LearningSystem = LearningSystem;
      console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ LearningSystem Ø§Ù„Ø¨Ø¯ÙŠÙ„');
    }
  </script>
  -->
  
  <!-- Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© (Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªÙˆÙØ±Ø©) -->
  <script src="js/intent-classifier.js"></script>
  <script src="js/indexeddb-manager.js"></script>
  <script src="js/query-parser.js"></script>
  <script src="js/learning-system.js"></script>
  <script src="js/response-generator.js"></script>

  <!-- Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ‚Ø¯Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) -->
  <script src="js/progress-indicator.js"></script>

  <!-- ========================================
       Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø§Ù„Ù†ÙˆØ§Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
       ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ø¨Ø¹Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª!
  ======================================== -->
  <script src="js/ai-expert-core.js"></script>

  <!-- ========================================
       Ø§Ù„Ø®Ø·ÙˆØ© 6: Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
  ======================================== -->
  <script src="js/voice-handler.js"></script>
  <script src="js/typewriter-effect.js"></script>
  <script src="js/ui-controller.js"></script>

  <!-- ========================================
       Ø§Ù„Ø®Ø·ÙˆØ© 7: Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ù„ØªØ´ØºÙŠÙ„
       Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£Ù‡Ù…!
  ======================================== -->
  <script>
    /**
     * ğŸš€ Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
     */
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ');
      console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');

      try {
        // === 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ===
        console.log('ğŸ“Š Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
        
        const vectorsReady = (
          (typeof activityVectors !== 'undefined' || typeof activityVectorsData !== 'undefined') &&
          (typeof decision104Vectors !== 'undefined' || typeof decisionVectorsData !== 'undefined') &&
          (typeof industrialVectors !== 'undefined' || typeof industrialVectorsData !== 'undefined')
        );
        
        if (!vectorsReady) {
          throw new Error('âŒ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…ØªØ¬Ù‡Ø§Øª ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©! ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª data/*.js');
        }
        
        console.log('âœ… Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø§Ù‡Ø²Ø©');

        // === 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ===
        console.log('ğŸ”§ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª...');
        
        const componentsReady = (
          typeof ArabicNormalizer !== 'undefined' &&
          typeof TransformersLoader !== 'undefined' &&
          typeof VectorEngineV7 !== 'undefined' &&
          typeof IntentClassifier !== 'undefined' &&
          typeof IndexedDBManager !== 'undefined' &&
          typeof QueryParser !== 'undefined' &&
          typeof LearningSystem !== 'undefined' &&
          typeof ResponseGenerator !== 'undefined' &&
          typeof AIExpertCore !== 'undefined' &&
          typeof VoiceHandler !== 'undefined' &&
          typeof TypewriterEffect !== 'undefined' &&
          typeof UIController !== 'undefined'
        );
        
        if (!componentsReady) {
          console.error('âŒ Ø¨Ø¹Ø¶ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ù…ÙÙ‚ÙˆØ¯Ø©!');
          console.error('   Ø§Ø­Ø°Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ù…Ù† Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø© ÙÙŠ HTML');
          throw new Error('Ù…ÙƒÙˆÙ†Ø§Øª Ù…ÙÙ‚ÙˆØ¯Ø©');
        }
        
        console.log('âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø©');

        // === 3. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… ===
        console.log('âš™ï¸  Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…...');
        
        const aiCore = new AIExpertCore();
        const voiceHandler = new VoiceHandler();
        const typewriterEffect = new TypewriterEffect();
        const responseGenerator = new ResponseGenerator();
        const uiController = new UIController(
          aiCore,
          voiceHandler,
          typewriterEffect,
          responseGenerator
        );
        
        console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª');

        // === 4. ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… ===
        console.log('ğŸ”„ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…...');
        
        const coreInitialized = await aiCore.initialize();
        
        if (!coreInitialized) {
          throw new Error('âŒ ÙØ´Ù„Øª ØªÙ‡ÙŠØ¦Ø© AIExpertCore');
        }
        
        console.log('âœ… ØªÙ…Øª ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†ÙˆØ§Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
        
        await uiController.initialize();
        
        console.log('âœ… ØªÙ…Øª ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©');

        // === 5. Ø­ÙØ¸ ÙÙŠ Window ===
        window.aiCore = aiCore;
        window.uiController = uiController;
        window.voiceHandler = voiceHandler;

        // === 6. Ø§ÙƒØªÙ…Ø§Ù„ ===
        console.log('');
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.log('âœ… âœ… âœ…  Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„!  âœ… âœ… âœ…');
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        
        const stats = aiCore.getStatistics();
        console.log('ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:');
        console.log(`   â€¢ Ø§Ù„Ø£Ù†Ø´Ø·Ø©: ${stats.databases.activity} Ø³Ø¬Ù„`);
        console.log(`   â€¢ Ø§Ù„Ù‚Ø±Ø§Ø± 104: ${stats.databases.decision104} Ø³Ø¬Ù„`);
        console.log(`   â€¢ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚: ${stats.databases.industrial} Ø³Ø¬Ù„`);
        console.log('');

        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        const statusText = document.querySelector('.status-text');
        if (statusText) {
          statusText.textContent = 'âœ… Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©';
          statusText.style.color = '#28a745';
        }

        // === 7. Ø¯Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹ ===
        window.quickTest = async () => {
          console.log('ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹...');
          const response = await aiCore.processQuery('Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©ØŸ');
          console.log('Ø§Ù„Ù†ØªÙŠØ¬Ø©:', response);
          return response;
        };
        
        console.log('ğŸ’¡ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±: Ø§ÙƒØªØ¨ quickTest() ÙÙŠ Console');

      } catch (error) {
        console.error('');
        console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.error('âŒ ÙØ´Ù„Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø©!');
        console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.error('Ø§Ù„Ø®Ø·Ø£:', error.message);
        console.error('Ø§Ù„ØªÙØ§ØµÙŠÙ„:', error);
        console.error('');
        
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        const statusText = document.querySelector('.status-text');
        if (statusText) {
          statusText.textContent = 'âŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ - Ø±Ø§Ø¬Ø¹ Console';
          statusText.style.color = '#dc3545';
        }
      }
    });
  </script>

</body>
</html>
